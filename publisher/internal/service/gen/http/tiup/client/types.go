// Code generated by goa v3.23.1, DO NOT EDIT.
//
// tiup HTTP client types
//
// Command:
// $ goa gen github.com/PingCAP-QE/ee-apps/publisher/internal/service/design -o
// ./service

package client

import (
	tiup "github.com/PingCAP-QE/ee-apps/publisher/internal/service/gen/tiup"
	goa "goa.design/goa/v3/pkg"
)

// RequestToPublishRequestBody is the type of the "tiup" service
// "request-to-publish" endpoint HTTP request body.
type RequestToPublishRequestBody struct {
	// The full url of the pushed OCI artifact, contain the tag part. It will parse
	// the repo from it.
	ArtifactURL string `form:"artifact_url" json:"artifact_url" xml:"artifact_url"`
	// `staging` is http://tiup.pingcap.net:8988, `prod` is
	// http://tiup.pingcap.net:8987.
	TiupMirror string `json:"tiup_mirror,omitempty"`
	// Force set the version. Default is the artifact version read from
	// `org.opencontainers.image.version` of the manifest config.
	Version *string `form:"version,omitempty" json:"version,omitempty" xml:"version,omitempty"`
}

// DeliveryByRulesRequestBody is the type of the "tiup" service
// "delivery-by-rules" endpoint HTTP request body.
type DeliveryByRulesRequestBody struct {
	// The full url of the pushed OCI artifact, contain the tag part. It will parse
	// the repo from it.
	ArtifactURL string `form:"artifact_url" json:"artifact_url" xml:"artifact_url"`
}

// RequestToPublishSingleRequestBody is the type of the "tiup" service
// "request-to-publish-single" endpoint HTTP request body.
type RequestToPublishSingleRequestBody struct {
	From    *FromRequestBody            `json:"from,omitempty"`
	Publish *PublishInfoTiUPRequestBody `json:"publish,omitempty"`
	// `staging` is http://tiup.pingcap.net:8988, `prod` is
	// http://tiup.pingcap.net:8987.
	TiupMirror string `json:"tiup_mirror,omitempty"`
}

// FromRequestBody is used to define fields on request body types.
type FromRequestBody struct {
	Type string               `json:"type,omitempty"`
	Oci  *FromOciRequestBody  `json:"oci,omitempty"`
	HTTP *FromHTTPRequestBody `json:"http,omitempty"`
}

// FromOciRequestBody is used to define fields on request body types.
type FromOciRequestBody struct {
	Repo string `json:"repo,omitempty"`
	Tag  string `json:"tag,omitempty"`
	File string `json:"file,omitempty"`
}

// FromHTTPRequestBody is used to define fields on request body types.
type FromHTTPRequestBody struct {
	URL string `json:"url,omitempty"`
}

// PublishInfoTiUPRequestBody is used to define fields on request body types.
type PublishInfoTiUPRequestBody struct {
	Name        string  `json:"name,omitempty"`
	Os          string  `json:"os,omitempty"`
	Arch        string  `json:"arch,omitempty"`
	Version     string  `json:"version,omitempty"`
	Description *string `json:"description,omitempty"`
	EntryPoint  *string `json:"entry_point,omitempty"`
	Standalone  *bool   `json:"standalone,omitempty"`
}

// NewRequestToPublishRequestBody builds the HTTP request body from the payload
// of the "request-to-publish" endpoint of the "tiup" service.
func NewRequestToPublishRequestBody(p *tiup.RequestToPublishPayload) *RequestToPublishRequestBody {
	body := &RequestToPublishRequestBody{
		ArtifactURL: p.ArtifactURL,
		TiupMirror:  p.TiupMirror,
		Version:     p.Version,
	}
	return body
}

// NewDeliveryByRulesRequestBody builds the HTTP request body from the payload
// of the "delivery-by-rules" endpoint of the "tiup" service.
func NewDeliveryByRulesRequestBody(p *tiup.DeliveryByRulesPayload) *DeliveryByRulesRequestBody {
	body := &DeliveryByRulesRequestBody{
		ArtifactURL: p.ArtifactURL,
	}
	return body
}

// NewRequestToPublishSingleRequestBody builds the HTTP request body from the
// payload of the "request-to-publish-single" endpoint of the "tiup" service.
func NewRequestToPublishSingleRequestBody(p *tiup.PublishRequestTiUP) *RequestToPublishSingleRequestBody {
	body := &RequestToPublishSingleRequestBody{
		TiupMirror: p.TiupMirror,
	}
	if p.From != nil {
		body.From = marshalTiupFromToFromRequestBody(p.From)
	}
	if p.Publish != nil {
		body.Publish = marshalTiupPublishInfoTiUPToPublishInfoTiUPRequestBody(p.Publish)
	}
	{
		var zero string
		if body.TiupMirror == zero {
			body.TiupMirror = "staging"
		}
	}
	return body
}

// ValidateFromRequestBody runs the validations defined on FromRequestBody
func ValidateFromRequestBody(body *FromRequestBody) (err error) {
	if !(body.Type == "oci" || body.Type == "http") {
		err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.type", body.Type, []any{"oci", "http"}))
	}
	return
}
