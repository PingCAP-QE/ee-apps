// Code generated by goa v3.23.1, DO NOT EDIT.
//
// tidbcloud HTTP server types
//
// Command:
// $ goa gen github.com/PingCAP-QE/ee-apps/publisher/internal/service/design -o
// ./service

package server

import (
	"unicode/utf8"

	tidbcloud "github.com/PingCAP-QE/ee-apps/publisher/internal/service/gen/tidbcloud"
	goa "goa.design/goa/v3/pkg"
)

// UpdateComponentVersionInCloudconfigRequestBody is the type of the
// "tidbcloud" service "update-component-version-in-cloudconfig" endpoint HTTP
// request body.
type UpdateComponentVersionInCloudconfigRequestBody struct {
	// env stage
	Stage *string `form:"stage,omitempty" json:"stage,omitempty" xml:"stage,omitempty"`
	// container image with tag
	Image *string `form:"image,omitempty" json:"image,omitempty" xml:"image,omitempty"`
}

// AddTidbxImageTagInTcmsRequestBody is the type of the "tidbcloud" service
// "add-tidbx-image-tag-in-tcms" endpoint HTTP request body.
type AddTidbxImageTagInTcmsRequestBody struct {
	// container image with tag
	Image *string `form:"image,omitempty" json:"image,omitempty" xml:"image,omitempty"`
	// git informations
	Github *struct {
		// full github repo name
		FullRepo *string `form:"full_repo" json:"full_repo" xml:"full_repo"`
		// git ref
		Ref *string `form:"ref" json:"ref" xml:"ref"`
		// full commit SHA
		CommitSha *string `form:"commit_sha" json:"commit_sha" xml:"commit_sha"`
	} `form:"github,omitempty" json:"github,omitempty" xml:"github,omitempty"`
}

// UpdateComponentVersionInCloudconfigResponseBody is the type of the
// "tidbcloud" service "update-component-version-in-cloudconfig" endpoint HTTP
// response body.
type UpdateComponentVersionInCloudconfigResponseBody struct {
	Stage   string                            `form:"stage" json:"stage" xml:"stage"`
	Tickets []*TidbcloudOpsTicketResponseBody `form:"tickets" json:"tickets" xml:"tickets"`
}

// AddTidbxImageTagInTcmsResponseBody is the type of the "tidbcloud" service
// "add-tidbx-image-tag-in-tcms" endpoint HTTP response body.
type AddTidbxImageTagInTcmsResponseBody struct {
	// github full repo
	Repo *string `json:"repo,omitempty"`
	// github branch or tag name
	Branch *string `json:"branch,omitempty"`
	// github commit sha in the repo
	Sha *string `json:"sha,omitempty"`
	// image tag
	ImageTag *string `json:"imageTag,omitempty"`
}

// TidbcloudOpsTicketResponseBody is used to define fields on response body
// types.
type TidbcloudOpsTicketResponseBody struct {
	// ticket ID
	ID string `form:"id" json:"id" xml:"id"`
	// ticket visit url
	URL string `form:"url" json:"url" xml:"url"`
	// release window ID
	ReleaseID *string `form:"release_id,omitempty" json:"release_id,omitempty" xml:"release_id,omitempty"`
	// component publish flow ID
	ChangeID *string `form:"change_id,omitempty" json:"change_id,omitempty" xml:"change_id,omitempty"`
	// component name
	Component string `form:"component" json:"component" xml:"component"`
	// component version derived from image tag
	ComponentVersion string `form:"component_version" json:"component_version" xml:"component_version"`
}

// NewUpdateComponentVersionInCloudconfigResponseBody builds the HTTP response
// body from the result of the "update-component-version-in-cloudconfig"
// endpoint of the "tidbcloud" service.
func NewUpdateComponentVersionInCloudconfigResponseBody(res *tidbcloud.UpdateComponentVersionInCloudconfigResult) *UpdateComponentVersionInCloudconfigResponseBody {
	body := &UpdateComponentVersionInCloudconfigResponseBody{
		Stage: res.Stage,
	}
	if res.Tickets != nil {
		body.Tickets = make([]*TidbcloudOpsTicketResponseBody, len(res.Tickets))
		for i, val := range res.Tickets {
			if val == nil {
				body.Tickets[i] = nil
				continue
			}
			body.Tickets[i] = marshalTidbcloudTidbcloudOpsTicketToTidbcloudOpsTicketResponseBody(val)
		}
	} else {
		body.Tickets = []*TidbcloudOpsTicketResponseBody{}
	}
	return body
}

// NewAddTidbxImageTagInTcmsResponseBody builds the HTTP response body from the
// result of the "add-tidbx-image-tag-in-tcms" endpoint of the "tidbcloud"
// service.
func NewAddTidbxImageTagInTcmsResponseBody(res *tidbcloud.AddTidbxImageTagInTcmsResult) *AddTidbxImageTagInTcmsResponseBody {
	body := &AddTidbxImageTagInTcmsResponseBody{
		Repo:     res.Repo,
		Branch:   res.Branch,
		Sha:      res.Sha,
		ImageTag: res.ImageTag,
	}
	return body
}

// NewUpdateComponentVersionInCloudconfigPayload builds a tidbcloud service
// update-component-version-in-cloudconfig endpoint payload.
func NewUpdateComponentVersionInCloudconfigPayload(body *UpdateComponentVersionInCloudconfigRequestBody) *tidbcloud.UpdateComponentVersionInCloudconfigPayload {
	v := &tidbcloud.UpdateComponentVersionInCloudconfigPayload{
		Stage: *body.Stage,
		Image: *body.Image,
	}

	return v
}

// NewAddTidbxImageTagInTcmsPayload builds a tidbcloud service
// add-tidbx-image-tag-in-tcms endpoint payload.
func NewAddTidbxImageTagInTcmsPayload(body *AddTidbxImageTagInTcmsRequestBody) *tidbcloud.AddTidbxImageTagInTcmsPayload {
	v := &tidbcloud.AddTidbxImageTagInTcmsPayload{
		Image: *body.Image,
	}
	if body.Github != nil {
		v.Github = &struct {
			// full github repo name
			FullRepo string
			// git ref
			Ref *string
			// full commit SHA
			CommitSha string
		}{
			FullRepo:  *body.Github.FullRepo,
			Ref:       body.Github.Ref,
			CommitSha: *body.Github.CommitSha,
		}
	}

	return v
}

// ValidateUpdateComponentVersionInCloudconfigRequestBody runs the validations
// defined on Update-Component-Version-In-CloudconfigRequestBody
func ValidateUpdateComponentVersionInCloudconfigRequestBody(body *UpdateComponentVersionInCloudconfigRequestBody) (err error) {
	if body.Stage == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("stage", "body"))
	}
	if body.Image == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("image", "body"))
	}
	return
}

// ValidateAddTidbxImageTagInTcmsRequestBody runs the validations defined on
// Add-Tidbx-Image-Tag-In-TcmsRequestBody
func ValidateAddTidbxImageTagInTcmsRequestBody(body *AddTidbxImageTagInTcmsRequestBody) (err error) {
	if body.Image == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("image", "body"))
	}
	if body.Github != nil {
		if body.Github.FullRepo == nil {
			err = goa.MergeErrors(err, goa.MissingFieldError("full_repo", "body.github"))
		}
		if body.Github.CommitSha == nil {
			err = goa.MergeErrors(err, goa.MissingFieldError("commit_sha", "body.github"))
		}
		if body.Github.CommitSha != nil {
			if utf8.RuneCountInString(*body.Github.CommitSha) < 40 {
				err = goa.MergeErrors(err, goa.InvalidLengthError("body.github.commit_sha", *body.Github.CommitSha, utf8.RuneCountInString(*body.Github.CommitSha), 40, true))
			}
		}
		if body.Github.CommitSha != nil {
			if utf8.RuneCountInString(*body.Github.CommitSha) > 40 {
				err = goa.MergeErrors(err, goa.InvalidLengthError("body.github.commit_sha", *body.Github.CommitSha, utf8.RuneCountInString(*body.Github.CommitSha), 40, false))
			}
		}
	}
	return
}
